<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Enter Access Code — Kryptosnite</title>
<style>
  :root{
    --bg:#06070a;
    --card:#0d1116;
    --muted:#98a6af;
    --accent:#39d9ff;
    --accent-2:#6effc3;
    --glass: rgba(255,255,255,0.03);
  }
  html,body{height:100%;margin:0;font-family:Inter,Segoe UI,system-ui,Helvetica,Arial}
  body{
    background: linear-gradient(180deg,#05060a 0%, #0b1116 100%);
    color:#eaf6ff; padding-bottom:60px;
  }

  /* Top banner */
  #scrollingBanner {
    position:fixed; top:0; left:0; right:0; height:56px;
    background:#071018; display:flex; align-items:center; z-index:999;
    box-shadow: 0 3px 8px rgba(0,0,0,0.5);
    padding:0 18px;
  }
  #scrollingText { white-space:nowrap; overflow:hidden; font-weight:600; color:var(--accent); animation: marquee 18s linear infinite; padding-left:100% }
  @keyframes marquee { 0%{transform:translateX(0)} 100%{transform:translateX(-100%)} }

  .top-right { margin-left:auto; display:flex; gap:12px; align-items:center }
  .pill { background:var(--glass); color:var(--muted); padding:8px 12px; border-radius:999px; font-size:13px; border:1px solid rgba(255,255,255,0.02) }
  .btn-logout { background:linear-gradient(90deg,var(--accent),var(--accent-2)); color:#042227; border:none; padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:700 }

  .page { max-width:980px; margin:100px auto 40px; padding:18px; }

  .card-in {
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:20px;border-radius:14px;border:1px solid rgba(255,255,255,0.02);
    box-shadow: 0 10px 30px rgba(2,6,23,0.5);
  }
  .headline { display:flex; align-items:center; gap:14px; margin-bottom:12px }
  .title { font-size:20px; font-weight:700 }
  .subtitle { color:var(--muted); font-size:14px }

  /* code box */
  .code-row { display:flex; gap:10px; margin-top:8px; align-items:center }
  .code-row input { flex:1;padding:12px;border-radius:10px;border:none;background:var(--glass);color:var(--muted); font-size:16px }
  .code-row button { padding:12px 16px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#042227;font-weight:700;cursor:pointer }

  /* LIST CARDS - stacked */
  .list { margin-top:20px; display:flex;flex-direction:column; gap:12px; }
  .site-card {
    display:flex; gap:14px; align-items:center; padding:14px; border-radius:12px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.02);
    transform: translateY(10px); opacity:0; animation:pop .45s forwards;
  }
  @keyframes pop { to {transform:none; opacity:1} }
  .logo-placeholder { width:78px; height:60px; border-radius:10px; background:linear-gradient(135deg,#0b1b22,#081018); display:flex;align-items:center;justify-content:center;color:var(--muted); font-weight:700; font-size:13px; border:1px solid rgba(255,255,255,0.02) }
  .site-info{flex:1}
  .site-title{font-weight:700;font-size:16px}
  .site-sub{color:var(--muted);font-size:13px;margin-top:4px}
  .visit { padding:10px 12px;border-radius:10px;border:none;background:transparent;color:var(--accent);font-weight:700;cursor:pointer }
  .priority { font-size:12px;color:var(--muted); padding:6px 8px;border-radius:8px;border:1px dashed rgba(255,255,255,0.03); margin-left:8px }

  /* small */
  @media (max-width:600px){
    .wrap-cols {flex-direction:column}
    .logo-placeholder{width:64px;height:48px}
  }
</style>
</head>
<body>

<!-- banner -->
<div id="scrollingBanner">
  <div id="scrollingText">Made by Jordan Piamonte • Watch Any UFC/Boxing Event Here For Free • Made by Jordan Piamonte</div>
  <div class="top-right">
    <div class="pill" id="whoami">...</div>
    <button class="btn-logout" onclick="logout()">Logout</button>
  </div>
</div>

<div class="page">
  <div class="card-in">
    <div class="headline">
      <div>
        <div class="title">Enter Access Code</div>
        <div class="subtitle">After login, enter the access code to reveal the stream sources.</div>
      </div>
    </div>

    <div class="code-row">
      <input id="codeInput" placeholder="Enter code (ask admin)" onkeydown="if(event.key==='Enter') verifyCode()" />
      <button onclick="verifyCode()">Unlock</button>
    </div>

    <div class="list" id="listContainer" style="display:none; margin-top:18px"></div>
  </div>

  <div style="margin-top:18px;color:var(--muted);font-size:13px">Tip: click <strong>Visit</strong> to open each source in a new tab. Logo placeholders let you upload your own image later.</div>
</div>

<script type="module">
  import { supabase } from './supabase.js'

  // Check session — if not logged in, send back to index
  (async ()=>{
    const { data } = await supabase.auth.getSession()
    if(!data?.session) location.href = 'index.html'
    else {
      const user = data.session.user
      document.getElementById('whoami').innerText = user.email
    }
  })()

  // sites data
  const sitesData = [
    { site: "Pirate Index", link: "https://fmhy.net/video#live-sports", priority: 1, desc: "Live sports index", logo: "" },
    { site: "StreamEast Mirrors", link: "https://v3.gostreameast.link/#mirrors", priority: 2, desc: "Mirror links for streams", logo: "" },
    { site: "SportSurge", link: "https://v2.sportsurge.net/home5/", priority: 3, desc: "Aggregate sports streams", logo: "" },
    { site: "StreamEast.Net", link: "https://stream-east.net/", priority: 4, desc: "Another StreamEast host", logo: "" },
    { site: "STRMD", link: "https://strmd.link/", priority: 5, desc: "Quick stream links", logo: "" },
    { site: "AllStream", link: "https://allstream.cc/", priority: 6, desc: "General streaming", logo: "" },
    { site: "Instant Replays HD", link: "https://watchmmafull.com/", priority: 7, desc: "Replay-focused streams", logo: "" }
  ]

  const CORRECT_CODE = "KRYPTOS2024" // change to your code

  function renderList() {
    const container = document.getElementById('listContainer')
    container.innerHTML = ''
    sitesData.forEach((s, i) => {
      const card = document.createElement('div')
      card.className = 'site-card'
      card.style.animationDelay = (i * 60) + 'ms' // stagger
      card.innerHTML = `
        <div class="logo-placeholder">Logo</div>
        <div class="site-info">
          <div class="site-title">${s.site} <span class="priority">#${s.priority}</span></div>
          <div class="site-sub">${s.desc}</div>
        </div>
        <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end">
          <button class="visit" onclick="openSite(${i})">Visit</button>
          <a style="font-size:12px;color:var(--muted)" href="${s.link}" target="_blank" rel="noopener noreferrer">raw link</a>
        </div>
      `
      container.appendChild(card)
    })
  }

  window.verifyCode = function(){
    const v = document.getElementById('codeInput').value.trim()
    if(v === CORRECT_CODE){
      document.getElementById('listContainer').style.display = 'flex'
      renderList()
    } else {
      alert('Incorrect code.')
    }
  }

  window.openSite = function(i){
    const s = sitesData[i]
    window.open(s.link, '_blank', 'noopener')
  }

  window.logout = async function(){
    await supabase.auth.signOut()
    location.href = 'index.html'
  }
</script>
</body>
</html>
